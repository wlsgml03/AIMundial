import pandas as pd

file_path = 'data/Data_ CERF Donor Contributions and Allocations - allocations.csv'
df = pd.read_csv(file_path)

# Filter by agency
target_agency = ['World Food Programme', 'Food and Agriculture Organization']
filtered_df = df[df['agencyName'].isin(target_agency)].copy()

# Filter by year
target_years = list(range(2016, 2027))
filtered_df = filtered_df[filtered_df['year'].isin(target_years)].copy()

# Group by Country + Year ONLY (combine both agencies)
filtered_df = (
    filtered_df
    .groupby(['countryName', 'year'], as_index=False)['totalAmountApproved']
    .sum()
)

filtered_df.to_csv(
    'clean_data/clean_allocations/allocations_combined.csv',
    index=False
)